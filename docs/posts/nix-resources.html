<!DOCTYPE html>
<html lang="en"> 
<head profile="http://www.w3.org/2005/10/profile">
    <meta charset="UTF-8">
    <meta name="description" content="Alessandro Marrella. Welcome to my website!">
    <meta name="author" content="Alessandro Marrella">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@amarrella">
<meta name="twitter:creator" content="@amarrella">
<meta name="twitter:title" content="How to get started with Nix">
    <meta name="twitter:description" content="Useful links and resources">
        <title>How to get started with Nix</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
</head>
<body>
    <header>
        <nav>
            <a id="beacon" href="/">
                <div id="home-text"> HOME </div>
            </a>
        </nav>
    
        <div class="right-sidebar">
            <a class="ext-link" href="https://github.com/amarrella">
            <img src="/images/github-logo.png" alt="Alessandro Marrella Github Profile"/>
        </a>

            <a class="ext-link" href="https://twitter.com/amarrella">
            <img src="/images/twitter-logo.png" alt="Alessandro Marrella Twitter Profile"/>
        </a>

            <a class="ext-link" href="https://linkedin.com/in/alessandromarrella">
            <img src="/images/linkedin-logo.png" alt="Alessandro Marrella Linkedin Profile"/>
        </a>
    </div>
    </header>

<div id="page">
    <div class="wrapper">
        <div class="masthead">
            <span class="title">
                How to get started with Nix
            </span>
            <br>

            <br>
            <span class="byline">by Alessandro Marrella</span>
            <br>
            <span class="date">2020-05-13</span>
            <br>
            <div class="metadata">
            </div>
        </div>
    </div>
    <article class="post">
        <p>I started learning Nix a few months ago, when it was introduced to the company I work for by some brilliant coworkers. I thought I'd share a few tips and resources that helped me start this journey to help newbies like me start working with this awesome tool.</p>
<h2 id="what-is-nix">What is Nix</h2>
<p>From <a href="https://nixos.org">nixos.org</a>:</p>
<blockquote>
<p>Nix is a powerful package manager for Linux and other Unix systems that makes package management reliable and reproducible. It provides atomic upgrades and rollbacks, side-by-side installation of multiple versions of a package, multi-user package management and easy setup of build environments.</p>
</blockquote>
<p>So yeah, this post talks about a package manager. Usually this is something not very exciting. I can feel readers just thinking "aren't you just happy with Brew?". The truth is that Nix solved so many problems well that it's very hard for me not to get excited about it!</p>
<p>Let's break down the features listed in the description above:</p>
<ul>
<li><em>package management</em>: well if this wasn't a feature we wouldn't really talk about a package manager</li>
<li><em>makes package management reliable and reproducible</em>: here stuff starts to get interesting. With Nix stuff works on <em>everyone</em>'s machine, not just yours. This is because of how packages are built. Nix will pull all the necessary dependencies for you and packages are usually guaranteed to not need anything else (it makes no assumptions on what you already have installed).</li>
<li><em>atomic upgrades and rollbacks</em>: for real, it's like having transactions but for installations. Because of how Nix works (more about it later), multiple versions of the same package can coexist in the system (!) so upgrading will just mean referencing the new version, rolling back referencing the old one. And for everything else, there is garbage collection :)</li>
<li><em>side by side installation of multiple version of a package</em>: i spoilered this in the point above. But this works <em>really</em> well. You no longer have to decide which version of <code>npm</code> you need in your system and you can even start ephemeral shells with specific versions of stuff.</li>
<li><em>multi user package management</em>: usually package managers install stuff in user space. Nix normally install stuff so that it's available to multiple users in the system.</li>
<li><em>easy setup of build environments</em>: it's <em>relatively easy</em> to set up isolated build environments with the packages and versions you need. I say relatively because you'd still have to learn Nix, and the learning curve is steep. But once you learn it, it empowers you to do this. It's much harder to achieve this with "easier" package managers (so much that people starting creating docker images with their build environments, ugh).</li>
</ul>
<p>I hope this list convinced you that learning Nix is worth it :) There are many more exciting features (like distributed binary caches), but now let's proceed with the learning stuff.</p>
<h2 id="how-to-learn-nix">How to learn Nix</h2>
<h3 id="learn-how-to-install-nix">Learn how to install Nix</h3>
<p>If you are on Linux or on a Mac Os X version <em>10.14 or earlier (NO CATALINA)</em> , no problem, just follow the instructions here: <a href="https://nixos.org/nix/manual/#sect-multi-user-installation" class="uri">https://nixos.org/nix/manual/#sect-multi-user-installation</a></p>
<p>I am linking to the multi user installation instructions because it seems to be the most frequently adopted in the community, so it might be easier to get help.</p>
<p>If you are on Mac Os X <em>10.15 or above (CATALINA or later)</em> you are in for some pain. Apple changed how they manage their file system and the <code>/</code> directory is locked. So you need to follow a quite significant workaround to get it installed (until <a href="https://github.com/NixOS/nix/pull/3212">this PR</a> gets merged).</p>
<ul>
<li>Create a volume for Nix via <a href="https://github.com/abathur/nix/blob/darwin-10.15-install-golden-path/scripts/create-darwin-volume.sh">this script</a></li>
<li>Install nix via: <code>curl -fsSL https://nixos.org/nix/install | sh /dev/stdin --daemon</code></li>
<li>Close the termainal. Open a new one. (yes this is necessary)</li>
</ul>
<h3 id="learn-to-use-nix-as-a-your-package-manager-replacement">Learn to use Nix as a your package manager replacement</h3>
<p>This video by Burke Libbey @ Shopify will explain briefly how to use nix as a "normal" package manager: <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/NYyImy-lqaA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<p>Note: to search packages, the video mentions this link: <a href="https://nixos.org/nixos/packages.html?channel=nixpkgs-unstable" class="uri">https://nixos.org/nixos/packages.html?channel=nixpkgs-unstable</a></p>
<h3 id="learn-how-to-create-packages-in-nix">Learn how to create packages in Nix</h3>
<p>Learning how to create packages is a super useful skill even if you want to use nix just as a package manager.</p>
<p>First things first, take a tour of the language (you can read up to slide 23, the later slides are way more advanced and not really required): <a href="https://nixcloud.io/tour/" class="uri">https://nixcloud.io/tour/</a></p>
<p>You can then</p>
    </article>

</div>

<footer>
    <p>© Alessandro Marrella 2020 - All opinions expressed are my own.</p>
    <p>Built with Haskell using <a href="https://github.com/ChrisPenner/slick">slick</a> ❤️</p>
</footer>

<script src="/js/main.js"></script>
</body>
</html>
